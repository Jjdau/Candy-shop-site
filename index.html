<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The Candy Shop LLC - Your mobile candy and convenience store! Discover sweet treats and find us at crcandyshop.com.">
  <meta name="keywords" content="candy shop, mobile candy store, convenience store, crcandyshop">
  <meta name="author" content="The Candy Shop LLC">
  <title>The Candy Shop LLC | Mobile Candy & Convenience Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Bubblegum+Sans&display=swap" rel="stylesheet">
  <style>
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .candy-bounce { animation: bounce 2s infinite; }
    .gradient-bg {
      background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1);
      background-size: 200% 200%;
      animation: gradient 15s ease infinite;
    }
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .candy-text {
      font-family: 'Bubblegum Sans', cursive;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s;
    }
    .candy-text:hover { transform: scale(1.05); }
    html { scroll-behavior: smooth; }
    :root {
      --logo-size-navbar: 12rem;
      --logo-size-hero-mobile: 25rem;
      --logo-size-hero-desktop: 20rem;
      --logo-size-footer: 12rem;
      --logo-margin-x-navbar: -5px;
      --logo-margin-y-navbar: 0;
      --logo-margin-x-hero: 0;
      --logo-margin-y-hero: 20px;
      --logo-margin-x-footer: 0;
      --logo-margin-y-footer: 0;
      --logo-gap-navbar: 10px;
      --logo-gap-hero: 15px;
      --logo-gap-footer: 10px;
      --logo-padding-navbar: 0 15px;
      --logo-padding-hero: 30px 0;
      --logo-padding-footer: 20px 0;
    }
    .logo-container { display: flex; align-items: center; justify-content: center; }
    .logo { max-height: 80%; max-width: 90%; }
    .carousel-container { position: relative; overflow: hidden; }
    .carousel-slide { transition: transform 0.5s ease-in-out; }
    .dropdown-form {
      transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
      overflow: hidden;
    }
    .dropdown-form.hidden { max-height: 0; opacity: 0; }
    .dropdown-form.visible { max-height: 500px; opacity: 1; }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
      overflow: auto;
    }
    .modal-content img {
      max-width: 100%;
      max-height: 80vh;
      object-fit: contain;
    }
    .modal-content button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 16px;
    }
    .admin-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .admin-modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .error-boundary {
      padding: 20px; text-align: center; color: red;
      background: #ffe6e6; margin: 20px; border-radius: 8px;
    }
    .calendar-day {
      cursor: pointer; transition: background-color 0.2s;
    }
    .calendar-day:hover { background-color: #f9a8d4; }
    .calendar-day.selected { background-color: #ec4899; color: white; }
  </style>
</head>
<body class="font-sans">
  <div id="root"></div>
  <div id="fallback" style="display: none; text-align: center; color: red; padding: 20px;">
    <h2>Error: Failed to load application</h2>
    <p>Scripts could not be loaded. Check your network, console, and ensure CDNs are accessible.</p>
  </div>

  <!-- React and Babel CDN scripts -->
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.24.7/babel.min.js"></script>

  <!-- Firebase initialization (v8.10.1 retained, v9 commented out) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyC40unSYPU3AdjWZINHFll_dHbOt9AWe68",
      authDomain: "the-candy-shop-fad88.firebaseapp.com",
      projectId: "the-candy-shop-fad88",
      storageBucket: "the-candy-shop-fad88.firebasestorage.app",
      messagingSenderId: "148707806077",
      appId: "1:148707806077:web:5fc31376b975b762ce1a14",
      measurementId: "G-NW4467SCWT"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    window.firebase = firebase;
    if (!window.firebase.firestore) {
      console.error("Firestore not initialized. Check script load order.");
    }

    /* Optional Firebase v9 (uncomment to use)
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getFirestore } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';
    import { getStorage } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js';
    
    const firebaseConfig = {
      apiKey: "AIzaSyC40unSYPU3AdjWZINHFll_dHbOt9AWe68",
      authDomain: "the-candy-shop-fad88.firebaseapp.com",
      projectId: "the-candy-shop-fad88",
      storageBucket: "the-candy-shop-fad88.firebasestorage.app",
      messagingSenderId: "148707806077",
      appId: "1:148707806077:web:5fc31376b975b762ce1a14",
      measurementId: "G-NW4467SCWT"
    };
    
    const app = initializeApp(firebaseConfig);
    window.firebase = { app, firestore: () => getFirestore(app), storage: () => getStorage(app) };
    */
  </script>

  <script type="text/babel">
    // Disable TypeScript and ESLint checks for CDN environment
    // @ts-nocheck
    /* eslint-disable */
    console.log("Starting script execution");
    if (!window.React || !window.ReactDOM || !window.Babel) {
      console.error("Required scripts (React, ReactDOM, or Babel) failed to load");
      document.getElementById("root").style.display = "none";
      document.getElementById("fallback").style.display = "block";
      throw new Error("Script loading failed");
    }
    console.log("Scripts loaded: React, ReactDOM, Babel");

    /** ErrorBoundary Component: Catches and displays runtime errors */
    const ErrorBoundary = ({ children }) => {
      const [error, setError] = React.useState(null);
      React.useEffect(() => {
        const errorHandler = (errorEvent) => {
          console.error("Caught error:", errorEvent.error || errorEvent);
          setError(errorEvent.error?.message || "An unexpected error occurred");
        };
        window.addEventListener("error", errorHandler);
        return () => window.removeEventListener("error", errorHandler);
      }, []);
      if (error) {
        return (
          <div className="error-boundary">
            <h2>Error: Something went wrong</h2>
            <p>{error}</p>
            <p>Please check the console for details and share with support.</p>
          </div>
        );
      }
      return children;
    };

    /** hashPassword: Simple hash function for admin password */
    const hashPassword = (password) => {
      let hash = 0;
      for (let i = 0; i < password.length; i++) {
        const char = password.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }
      return hash.toString();
    };
    const ADMIN_HASH = hashPassword('TheCandyShopLLC319*');

    /** sanitizeInput: Cleans user input to prevent XSS */
    const sanitizeInput = (input) => {
      if (typeof input !== 'string') return input;
      return input
        .replace(/<[^>]*>/g, '') // Strip HTML tags
        .replace(/[&<>"]/g, (m) => ({
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;'
        }[m]));
    };

    /** AdminModal Component: Login prompt for admin mode */
    const AdminModal = ({ isOpen, onClose, onLogin }) => {
      const [password, setPassword] = React.useState("");
      const [loginAttempts, setLoginAttempts] = React.useState(0);
      const handleSubmit = (e) => {
        e.preventDefault();
        if (loginAttempts >= 3) {
          alert("Too many attempts. Please try again later.");
          return;
        }
        setLoginAttempts(loginAttempts + 1);
        onLogin(hashPassword(password));
        setPassword("");
      };
      if (!isOpen) return null;
      return (
        <div className="admin-modal" onClick={onClose}>
          <div className="admin-modal-content" onClick={(e) => e.stopPropagation()}>
            <h3 className="text-2xl font-bold text-center mb-4 candy-text">Admin Login</h3>
            <form onSubmit={handleSubmit} className="space-y-4">
              <div>
                <label htmlFor="admin-password" className="block text-gray-600">Password</label>
                <input
                  id="admin-password"
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(sanitizeInput(e.target.value))}
                  className="w-full p-2 border rounded"
                  required
                  autocomplete="current-password"
                />
              </div>
              <div className="flex space-x-4">
                <button type="submit" className="flex-1 bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Login</button>
                <button type="button" onClick={onClose} className="flex-1 bg-gray-500 text-white p-2 rounded hover:bg-gray-700">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      );
    };

    /** ImageModal Component: Displays full-size images */
    const ImageModal = ({ isOpen, onClose, imageSrc }) => {
      if (!isOpen) return null;
      return (
        <div className="modal" onClick={onClose}>
          <div className="modal-content" onClick={(e) => e.stopPropagation()}>
            <img src={imageSrc} alt="Full size" className="w-full h-auto" />
            <button onClick={onClose}>Close</button>
          </div>
        </div>
      );
    };

    /** NavBar Component: Navigation bar with auto-close on selection */
    const NavBar = ({ adminMode, setAdminMode }) => {
      const [isOpen, setIsOpen] = React.useState(false);
      const [clickCount, setClickCount] = React.useState(0);
      const [showAdminModal, setShowAdminModal] = React.useState(false);
      React.useEffect(() => {
        if (clickCount > 0) {
          const timer = setTimeout(() => setClickCount(0), 3000);
          return () => clearTimeout(timer);
        }
      }, [clickCount]);
      const handleLogoClick = (e) => {
        e.preventDefault();
        setClickCount((prev) => {
          const newCount = prev + 1;
          if (newCount >= 5) {
            setShowAdminModal(true);
            return 0;
          }
          return newCount;
        });
      };
      const handleAdminLogin = (hashedPassword) => {
        if (hashedPassword === ADMIN_HASH) {
          setAdminMode(true);
          setShowAdminModal(false);
        } else {
          alert("Incorrect password");
        }
      };
      const closeMenu = () => setIsOpen(false);
      return (
        <>
          <nav className="bg-pink-500 text-white sticky top-0 z-50 shadow-lg">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="flex justify-between h-16" style={{ gap: 'var(--logo-gap-navbar)', padding: 'var(--logo-padding-navbar)' }}>
                <div className="logo-container" style={{ justifyContent: 'flex-start' }}>
                  <div onClick={handleLogoClick} style={{ cursor: 'pointer' }}>
                    <img src="assets/logo.png" alt="The Candy Shop LLC" style={{ height: 'var(--logo-size-navbar)', marginLeft: 'var(--logo-margin-x-navbar)', marginTop: 'var(--logo-margin-y-navbar)' }} className="w-auto logo" onError={(e) => { e.target.src = "https://via.placeholder.com/150x32?text=Logo"; }} />
                  </div>
                </div>
                <div className="hidden md:flex space-x-4 items-center">
                  <a href="#home" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Home</a>
                  <a href="#about" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>About</a>
                  <a href="#gallery" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Gallery</a>
                  <a href="#reviews" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Reviews</a>
                  <a href="#events" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Events</a>
                  <a href="#contact" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Contact</a>
                  <a href="#sale" className="hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Sale</a>
                  {adminMode && <button onClick={() => { setAdminMode(false); closeMenu(); }} className="hover:bg-pink-700 px-3 py-2 rounded candy-text">Logout</button>}
                </div>
                <div className="md:hidden flex items-center">
                  <button onClick={() => setIsOpen(!isOpen)} className="focus:outline-none">
                    {isOpen ? (
                      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    ) : (
                      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                      </svg>
                    )}
                  </button>
                </div>
              </div>
            </div>
            {isOpen && (
              <div className="md:hidden">
                <div className="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                  <a href="#home" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Home</a>
                  <a href="#about" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>About</a>
                  <a href="#gallery" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Gallery</a>
                  <a href="#reviews" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Reviews</a>
                  <a href="#events" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Events</a>
                  <a href="#contact" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Contact</a>
                  <a href="#sale" className="block hover:bg-pink-700 px-3 py-2 rounded candy-text" onClick={closeMenu}>Sale</a>
                  {adminMode && <button onClick={() => { setAdminMode(false); closeMenu(); }} className="block hover:bg-pink-700 px-3 py-2 rounded candy-text">Logout</button>}
                </div>
              </div>
            )}
          </nav>
          <AdminModal isOpen={showAdminModal} onClose={() => setShowAdminModal(false)} onLogin={handleAdminLogin} />
        </>
      );
    };

    /** Hero Component: Homepage banner */
    const Hero = () => (
      <section id="home" className="gradient-bg text-white py-20 text-center">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center logo-container" style={{ gap: 'var(--logo-gap-hero)', padding: 'var(--logo-padding-hero)' }}>
          <img src="assets/logo.png" alt="The Candy Shop LLC" className="w-auto candy-bounce md:h-[var(--logo-size-hero-desktop)] logo" style={{ height: 'var(--logo-size-hero-mobile)', marginLeft: 'var(--logo-margin-x-hero)', marginTop: 'var(--logo-margin-y-hero)' }} onError={(e) => { e.target.src = "https://via.placeholder.com/300x96?text=Logo"; }} />
          <p className="mt-4 text-lg md:text-2xl candy-text">Your Mobile Candy & Convenience Store!</p>
          <p className="mt-2 text-md md:text-lg candy-text">Bringing Sweet Treats to You!</p>
          <a href="#contact" className="mt-6 inline-block bg-yellow-400 text-black px-6 py-3 rounded-full font-bold hover:bg-yellow-500 candy-text">Get in Touch</a>
        </div>
      </section>
    );

    /** About Component: Editable about section */
    const About = ({ adminMode }) => {
      const [aboutText, setAboutText] = React.useState(() => {
        const saved = localStorage.getItem('aboutText');
        try {
          return saved ? JSON.parse(saved) : "The Candy Shop LLC is your go-to mobile candy and convenience store, delivering a burst of sweetness wherever you are! From gummy bears to chocolate bars and savory snacks, we’ve got it all. Follow us on social media to find our next stop!";
        } catch (e) {
          console.error("Failed to parse aboutText from localStorage:", e);
          return "The Candy Shop LLC is your go-to mobile candy and convenience store, delivering a burst of sweetness wherever you are! From gummy bears to chocolate bars and savory snacks, we’ve got it all. Follow us on social media to find our next stop!";
        }
      });
      const [isEditing, setIsEditing] = React.useState(false);
      const [editText, setEditText] = React.useState(aboutText);
      React.useEffect(() => {
        localStorage.setItem('aboutText', JSON.stringify(aboutText));
      }, [aboutText]);
      const handleEdit = () => {
        setIsEditing(true);
        setEditText(aboutText);
      };
      const handleSave = (e) => {
        e.preventDefault();
        setAboutText(sanitizeInput(editText));
        setIsEditing(false);
      };
      return (
        <section id="about" className="py-16 bg-gray-100">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="text-3xl font-bold text-center mb-8 candy-text">About Us</h2>
            {isEditing && adminMode ? (
              <form onSubmit={handleSave} className="max-w-3xl mx-auto space-y-4">
                <textarea value={editText} onChange={(e) => setEditText(e.target.value)} className="w-full p-2 border rounded" rows="5" required autocomplete="off"></textarea>
                <div className="flex space-x-4">
                  <button type="submit" className="flex-1 bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Save</button>
                  <button type="button" onClick={() => setIsEditing(false)} className="flex-1 bg-gray-500 text-white p-2 rounded hover:bg-gray-700">Cancel</button>
                </div>
              </form>
            ) : (
              <div className="text-lg text-gray-600 text-center max-w-3xl mx-auto">
                <p>{aboutText}</p>
                {adminMode && <button onClick={handleEdit} className="mt-4 bg-pink-500 text-white px-4 py-2 rounded hover:bg-pink-700">Edit</button>}
              </div>
            )}
          </div>
        </section>
      );
    };

    /** Gallery Component: Image gallery with full-size modal */
    const Gallery = () => {
      const [modalOpen, setModalOpen] = React.useState(false);
      const [selectedImage, setSelectedImage] = React.useState(null);
      const [photos, setPhotos] = React.useState([]);
      React.useEffect(() => {
        if (window.firebase && window.firebase.firestore) {
          const unsubscribe = window.firebase.firestore().collection("photos").onSnapshot((snapshot) => {
            setPhotos(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
            console.log("Fetched photos:", snapshot.docs.map(doc => doc.data()));
          }, (error) => {
            console.error("Error fetching photos:", error);
          });
          return () => unsubscribe();
        } else {
          console.error("Firebase Firestore not available");
        }
      }, []);

      const handleImageClick = (src) => {
        setSelectedImage(src);
        setModalOpen(true);
      };
      return (
        <section id="gallery" className="py-16">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="text-3xl font-bold text-center mb-8 candy-text">Our Sweet Vibes</h2>
            <div className="grid md:grid-cols-3 gap-6">
              {photos.map((photo) => (
                <div key={photo.id} className="relative group" onClick={() => handleImageClick(photo.url)}>
                  <img src={photo.url} alt={photo.caption} className="w-full h-48 object-cover rounded-lg cursor-pointer" onError={(e) => { console.error(`Image load failed for ${photo.url}:`, e); e.target.src = "https://via.placeholder.com/150x150?text=No+Image"; }} />
                  <p className="mt-2 text-center text-gray-600">{photo.caption}</p>
                </div>
              ))}
            </div>
          </div>
          <ImageModal isOpen={modalOpen} onClose={() => setModalOpen(false)} imageSrc={selectedImage} />
        </section>
      );
    };

    /** Reviews Component: Customer reviews with carousel and real-time updates */
    const Reviews = ({ adminMode }) => {
      const [reviews, setReviews] = React.useState([]);
      React.useEffect(() => {
        if (window.firebase && window.firebase.firestore) {
          const unsubscribe = window.firebase.firestore().collection("reviews").onSnapshot((snapshot) => {
            setReviews(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
          }, (error) => {
            console.error("Error fetching reviews:", error);
          });
          return () => unsubscribe();
        } else {
          console.error("Firebase Firestore not available");
        }
      }, []);

      const [currentIndex, setCurrentIndex] = React.useState(0);
      const [newReview, setNewReview] = React.useState({ name: "", rating: 5, comment: "" });
      const [isFormOpen, setIsFormOpen] = React.useState(false);

      React.useEffect(() => {
        const interval = setInterval(() => setCurrentIndex((prev) => (prev + 1) % reviews.length), 5000);
        return () => clearInterval(interval);
      }, [reviews]);

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (newReview.name && newReview.comment) {
          const newReviewData = { name: sanitizeInput(newReview.name), rating: newReview.rating, comment: sanitizeInput(newReview.comment), timestamp: new Date() };
          await window.firebase.firestore().collection("reviews").add(newReviewData);
          setNewReview({ name: "", rating: 5, comment: "" });
          setIsFormOpen(false);
        }
      };

      const handleDelete = async (id) => {
        await window.firebase.firestore().collection("reviews").doc(id).delete();
        setCurrentIndex((prev) => (prev >= reviews.length - 1 ? 0 : prev));
      };

      const handlePrev = () => setCurrentIndex((prev) => (prev - 1 + reviews.length) % reviews.length);
      const handleNext = () => setCurrentIndex((prev) => (prev + 1) % reviews.length);

      return (
        <section id="reviews" className="py-16 bg-gray-100">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="text-3xl font-bold text-center mb-4 candy-text">What Our Customers Say</h2>
            <p className="text-center text-gray-600 mb-8">Reviews are synced in real-time via Firebase.</p>
            <div className="carousel-container mb-8">
              <div className="relative">
                <div className="bg-white p-6 rounded-lg shadow-lg text-center">
                  <div className="text-yellow-400 mb-2 flex justify-center">
                    {Array.from({ length: Math.floor(reviews[currentIndex]?.rating || 0) }, (_, i) => (
                      <svg key={i} className="w-5 h-5 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                      </svg>
                    ))}
                    {(reviews[currentIndex]?.rating || 0) % 1 !== 0 && (
                      <svg className="w-5 h-5 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" clip-path="url(#half)"/>
                        <defs><clipPath id="half"><rect x="0" y="0" width="12" height="24"/></clipPath></defs>
                      </svg>
                    )}
                  </div>
                  <p className="text-gray-600 mb-4">"{reviews[currentIndex]?.comment || 'No reviews yet'}"</p>
                  <p className="font-semibold">{reviews[currentIndex]?.name || 'Anonymous'}</p>
                  {adminMode && reviews[currentIndex]?.id && <button onClick={() => handleDelete(reviews[currentIndex].id)} className="mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-700">Delete</button>}
                </div>
                <button onClick={handlePrev} className="absolute top-1/2 left-0 transform -translate-y-1/2 bg-pink-500 text-white p-2 rounded-full flex items-center justify-center" aria-label="Previous review">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"></path>
                  </svg>
                </button>
                <button onClick={handleNext} className="absolute top-1/2 right-0 transform -translate-y-1/2 bg-pink-500 text-white p-2 rounded-full flex items-center justify-center" aria-label="Next review">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </button>
              </div>
            </div>
            <div className="max-w-lg mx-auto">
              <button onClick={() => setIsFormOpen(!isFormOpen)} className="w-full bg-pink-500 text-white p-2 rounded hover:bg-pink-700 mb-4">{isFormOpen ? "Hide Review Form" : "Leave a Review"}</button>
              <div className={`dropdown-form ${isFormOpen ? 'visible' : 'hidden'}`}>
                <form onSubmit={handleSubmit} className="space-y-4">
                  <div>
                    <label htmlFor="name" className="block text-gray-600">Name</label>
                    <input id="name" type="text" value={newReview.name} onChange={(e) => setNewReview({ ...newReview, name: e.target.value })} className="w-full p-2 border rounded" required aria-required="true" autocomplete="name" />
                  </div>
                  <div>
                    <label htmlFor="rating" className="block text-gray-600">Rating</label>
                    <select id="rating" value={newReview.rating} onChange={(e) => setNewReview({ ...newReview, rating: parseFloat(e.target.value) })} className="w-full p-2 border rounded" aria-required="true">
                      {[1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5].map((r) => <option key={r} value={r}>{r} Stars</option>)}
                    </select>
                  </div>
                  <div>
                    <label htmlFor="comment" className="block text-gray-600">Comment</label>
                    <textarea id="comment" value={newReview.comment} onChange={(e) => setNewReview({ ...newReview, comment: e.target.value })} className="w-full p-2 border rounded" rows="4" required aria-required="true" autocomplete="off"></textarea>
                  </div>
                  <button type="submit" className="w-full bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Submit Review</button>
                </form>
              </div>
            </div>
          </div>
        </section>
      );
    };

    /** Events Component: Event calendar with real-time updates */
    const Events = ({ adminMode }) => {
      const [events, setEvents] = React.useState([]);
      React.useEffect(() => {
        if (window.firebase && window.firebase.firestore) {
          const unsubscribe = window.firebase.firestore().collection("events").onSnapshot((snapshot) => {
            setEvents(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
          }, (error) => {
            console.error("Error fetching events:", error);
          });
          return () => unsubscribe();
        } else {
          console.error("Firebase Firestore not available");
        }
      }, []);

      const [selectedDay, setSelectedDay] = React.useState(null);
      const [weekOffset, setWeekOffset] = React.useState(0);
      const [newEvent, setNewEvent] = React.useState({ title: "", date: "", time: "", location: "" });
      const [editEvent, setEditEvent] = React.useState(null);

      const getWeekDays = () => {
        const today = new Date();
        today.setDate(today.getDate() + weekOffset * 7);
        const startOfWeek = new Date(today.setDate(today.getDate() - today.getDay() + 1));
        const days = [];
        for (let i = 0; i < 7; i++) {
          const day = new Date(startOfWeek);
          day.setDate(startOfWeek.getDate() + i);
          const dateStr = day.toISOString().split('T')[0];
          days.push({ date: dateStr, label: day.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }) });
        }
        return days;
      };

      const handleDayClick = (date) => {
        setSelectedDay((prev) => (prev === date ? null : date));
        setEditEvent(null);
      };

      const handleAllEventsClick = () => {
        setSelectedDay((prev) => (prev === 'all' ? null : 'all'));
        setEditEvent(null);
      };

      const handleWeekChange = (direction) => {
        setWeekOffset((prev) => prev + direction);
        setEditEvent(null);
      };

      const handleEventSubmit = async (e) => {
        e.preventDefault();
        if (newEvent.title && newEvent.date && newEvent.time && newEvent.location) {
          await window.firebase.firestore().collection("events").add({ title: sanitizeInput(newEvent.title), date: newEvent.date, time: sanitizeInput(newEvent.time), location: sanitizeInput(newEvent.location) });
          setNewEvent({ title: "", date: "", time: "", location: "" });
        }
      };

      const handleEventEdit = (event) => setEditEvent(event);

      const handleEditSubmit = async (e) => {
        e.preventDefault();
        if (editEvent.title && editEvent.date && editEvent.time && editEvent.location) {
          await window.firebase.firestore().collection("events").doc(editEvent.id).set({ title: sanitizeInput(editEvent.title), date: editEvent.date, time: sanitizeInput(editEvent.time), location: sanitizeInput(editEvent.location) });
          setEditEvent(null);
        }
      };

      const handleEventDelete = async (id) => {
        await window.firebase.firestore().collection("events").doc(id).delete();
        setEditEvent(null);
      };

      const filteredEvents = selectedDay ? (selectedDay === 'all' ? events : events.filter((event) => new Date(event.date).toISOString().split('T')[0] === selectedDay)) : [];

      return (
        <section id="events" className="py-16">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="text-3xl font-bold text-center mb-8 candy-text">Where to Find Us</h2>
            <div className="flex justify-between mb-4">
              <button onClick={() => handleWeekChange(-1)} className="bg-pink-500 text-white px-4 py-2 rounded hover:bg-pink-700">Previous Week</button>
              <button onClick={() => handleWeekChange(1)} className="bg-pink-500 text-white px-4 py-2 rounded hover:bg-pink-700">Next Week</button>
            </div>
            <div className="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-7 gap-2 mb-8">
              {getWeekDays().map((day) => (
                <div key={day.date} onClick={() => handleDayClick(day.date)} className={`calendar-day p-4 text-center rounded-lg ${selectedDay === day.date ? 'selected' : 'bg-gray-100'}`}>
                  {day.label}
                </div>
              ))}
              <div onClick={handleAllEventsClick} className={`calendar-day p-4 text-center rounded-lg ${selectedDay === 'all' ? 'selected' : 'bg-gray-100'}`}>All Events</div>
            </div>
            <ul className="space-y-4 mb-8">
              {selectedDay === null ? (
                <p className="text-center text-gray-600">Select a date or "All Events" to view events</p>
              ) : filteredEvents.length > 0 ? (
                filteredEvents.map((event) => (
                  <li key={event.id} className="bg-white p-4 rounded-lg shadow flex justify-between items-center">
                    <div>
                      <h3 className="text-xl font-bold">{event.title}</h3>
                      <p><strong>Date:</strong> {new Date(event.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}</p>
                      <p><strong>Time:</strong> {event.time}</p>
                      <p><strong>Location:</strong> {event.location}</p>
                    </div>
                    {adminMode && (
                      <div className="flex space-x-2">
                        <button onClick={() => handleEventEdit(event)} className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700">Edit</button>
                        <button onClick={() => handleEventDelete(event.id)} className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-700">Delete</button>
                      </div>
                    )}
                  </li>
                ))
              ) : (
                <p className="text-center text-gray-600">No events for this selection.</p>
              )}
            </ul>
            {adminMode && editEvent && (
              <div className="max-w-md mx-auto mb-8">
                <h3 className="text-2xl font-bold text-center mb-4 candy-text">Edit Event</h3>
                <form onSubmit={handleEditSubmit} className="space-y-4">
                  <div>
                    <label htmlFor="edit-title" className="block text-gray-600">Event Title</label>
                    <input id="edit-title" type="text" value={editEvent.title} onChange={(e) => setEditEvent({ ...editEvent, title: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="edit-date" className="block text-gray-600">Date (YYYY-MM-DD)</label>
                    <input id="edit-date" type="date" value={editEvent.date} onChange={(e) => setEditEvent({ ...editEvent, date: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="edit-time" className="block text-gray-600">Time (e.g., 8:00 AM - 2:00 PM)</label>
                    <input id="edit-time" type="text" value={editEvent.time} onChange={(e) => setEditEvent({ ...editEvent, time: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="edit-location" className="block text-gray-600">Location (e.g., Main St., Cedar Rapids, IA)</label>
                    <input id="edit-location" type="text" value={editEvent.location} onChange={(e) => setEditEvent({ ...editEvent, location: e.target.value })} className="w-full p-2 border rounded" required autocomplete="address-line1" />
                  </div>
                  <div className="flex space-x-4">
                    <button type="submit" className="flex-1 bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Save</button>
                    <button type="button" onClick={() => setEditEvent(null)} className="flex-1 bg-gray-500 text-white p-2 rounded hover:bg-gray-700">Cancel</button>
                  </div>
                </form>
              </div>
            )}
            {adminMode && !editEvent && (
              <div className="max-w-md mx-auto">
                <h3 className="text-2xl font-bold text-center mb-4 candy-text">Add Event</h3>
                <form onSubmit={handleEventSubmit} className="space-y-4">
                  <div>
                    <label htmlFor="title" className="block text-gray-600">Event Title</label>
                    <input id="title" type="text" value={newEvent.title} onChange={(e) => setNewEvent({ ...newEvent, title: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="date" className="block text-gray-600">Date (YYYY-MM-DD)</label>
                    <input id="date" type="date" value={newEvent.date} onChange={(e) => setNewEvent({ ...newEvent, date: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="time" className="block text-gray-600">Time (e.g., 8:00 AM - 2:00 PM)</label>
                    <input id="time" type="text" value={newEvent.time} onChange={(e) => setNewEvent({ ...newEvent, time: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="location" className="block text-gray-600">Location (e.g., Main St., Cedar Rapids, IA)</label>
                    <input id="location" type="text" value={newEvent.location} onChange={(e) => setNewEvent({ ...newEvent, location: e.target.value })} className="w-full p-2 border rounded" required autocomplete="address-line1" />
                  </div>
                  <button type="submit" className="w-full bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Add Event</button>
                </form>
              </div>
            )}
          </div>
        </section>
      );
    };

    /** Contact Component: Contact information and social links */
    const Contact = () => (
      <section id="contact" className="py-16">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <h2 className="text-3xl font-bold text-center mb-8 candy-text">Contact Us</h2>
          <div className="max-w-lg mx-auto text-center">
            <p className="text-lg text-gray-600 mb-4">
              <svg className="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 8l9-6 9 6v10a2 2 0 01-2 2H5a2 2 0 01-2-2V8z"></path>
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M16 12H8"></path>
              </svg>
              <a href="mailto:TheCandyShop319@gmail.com" className="text-pink-500 hover:underline">TheCandyShop319@gmail.com</a>
            </p>
            <p className="text-lg text-gray-600 mb-4">
              <svg className="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              Follow our mobile shop on social media!
            </p>
            <div className="flex justify-center space-x-4">
              <a href="https://www.facebook.com/people/The-Candy-Shop-LLC/61575132523484/" className="text-2xl text-pink-500 hover:text-pink-700">
                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.563V12h2.773l-.443 2.89h-2.33v6.987C18.343 21.128 22 16.991 22 12z"/>
                </svg>
              </a>
              <a href="https://www.instagram.com/crcandyshop" className="text-2xl text-pink-500 hover:text-pink-700">
                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.326 3.608 1.301.975.975 1.24 2.242 1.301 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.062 1.366-.326 2.633-1.301 3.608-.975.975-2.242 1.24-3.608 1.301-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.326-3.608-1.301-.975-.975-1.24-2.242-1.301-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.062-1.366.326-2.633 1.301-3.608.975-.975 2.242-1.24 3.608-1.301 1.266-.058 1.646-.07 4.85-.07zM12 0C8.741 0 8.332.014 7.052.072 5.771.13 4.406.426 3.182 1.65 1.958 2.873 1.662 4.239 1.604 5.52 1.546 6.801 1.532 7.21 1.532 12s.014 5.199.072 6.48c.058 1.281.354 2.647 1.578 3.87 1.224 1.224 2.59 1.52 3.87 1.578 1.281.058 1.69.072 6.48.072s5.199-.014 6.48-.072c1.281-.058 2.647-.354 3.87-1.578 1.224-1.224 1.52-2.59 1.578-3.87.058-1.281.072-1.69.072-6.48s-.014-5.199-.072-6.48c-.058-1.281-.354-2.647-1.578-3.87-1.224-1.224-2.59-1.52-3.87-1.578C16.199.014 15.79 0 12 0z"/>
                  <path d="M12 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zm0 10.162a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.88 1.44 1.44 0 000-2.88z"/>
                </svg>
              </a>
              <a href="https://x.com/yourpage" className="text-2xl text-pink-500 hover:text-pink-700">
                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </a>
              <a href="https://www.tiktok.com/@crcandyshop319?_t=ZT-8vtVXLYmAgN&_r=1" className="text-2xl text-pink-500 hover:text-pink-700">
                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.81 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </section>
    );

    /** Footer Component: Site footer */
    const Footer = () => (
      <footer className="bg-pink-500 text-white py-8">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center logo-container" style={{ gap: 'var(--logo-gap-footer)', padding: 'var(--logo-padding-footer)' }}>
          <div className="flex justify-center">
            <img src="assets/logo.png" alt="The Candy Shop LLC" style={{ height: 'var(--logo-size-footer)', marginLeft: 'var(--logo-margin-x-footer)', marginTop: 'var(--logo-margin-y-footer)' }} className="w-auto logo" onError={(e) => { e.target.src = "https://via.placeholder.com/150x32?text=Logo"; }} />
          </div>
          <p className="text-center text-gray-200">© 2025 The Candy Shop LLC. All rights reserved.</p>
          <p className="text-center text-gray-200 mt-2">Visit us at <a href="http://crcandyshop.com" className="underline hover:text-yellow-400">crcandyshop.com</a></p>
        </div>
      </footer>
    );

    /** Sale Component: Display and manage sale items with file uploads */
    const Sale = ({ adminMode }) => {
      const [items, setItems] = React.useState([]);
      const [newItem, setNewItem] = React.useState({ category: "Candy", image: null, imageUrl: "", description: "", price: "", sold: false });
      const [editItem, setEditItem] = React.useState(null);
      const [modalOpen, setModalOpen] = React.useState(false);
      const [selectedImage, setSelectedImage] = React.useState(null);

      React.useEffect(() => {
        if (window.firebase && window.firebase.firestore) {
          const unsubscribe = window.firebase.firestore().collection("sales").onSnapshot((snapshot) => {
            setItems(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
          }, (error) => {
            console.error("Error fetching sales:", error);
          });
          return () => unsubscribe();
        } else {
          console.error("Firebase Firestore not available");
        }
      }, []);

      const uploadImage = async (file) => {
        if (!file) return null;
        const storageRef = window.firebase.storage().ref();
        const fileRef = storageRef.child(`sales/${file.name}`);
        await fileRef.put(file);
        const url = await fileRef.getDownloadURL();
        return url;
      };

      const saveItem = async (item, file) => {
        let imageUrl = item.imageUrl;
        if (file) {
          imageUrl = await uploadImage(file);
        }
        const itemData = { category: item.category, image: imageUrl, description: item.description, price: parseFloat(item.price), sold: item.sold };
        if (item.id) {
          await window.firebase.firestore().collection("sales").doc(item.id).set(itemData);
        } else {
          await window.firebase.firestore().collection("sales").add(itemData);
        }
      };

      const handleAddItem = async (e) => {
        e.preventDefault();
        if (newItem.image && newItem.description && newItem.price) {
          await saveItem(newItem, newItem.image);
          setNewItem({ category: "Candy", image: null, imageUrl: "", description: "", price: "", sold: false });
        }
      };

      const handleEditItem = (item) => setEditItem({ ...item, image: null, imageUrl: item.image });

      const handleEditSubmit = async (e) => {
        e.preventDefault();
        if (editItem.imageUrl && editItem.description && editItem.price) {
          await saveItem(editItem, editItem.image);
          setEditItem(null);
        }
      };

      const handleDeleteItem = async (id) => {
        await window.firebase.firestore().collection("sales").doc(id).delete();
        setEditItem(null);
      };

      const handleImageClick = (src) => {
        setSelectedImage(src);
        setModalOpen(true);
      };

      return (
        <section id="sale" className="py-16 bg-gray-100">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="text-3xl font-bold text-center mb-8 candy-text">Sale Items</h2>
            <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
              {items.map((item) => (
                <div key={item.id} className="bg-white p-4 rounded-lg shadow hover:shadow-lg transition-shadow">
                  <img src={item.image} alt={item.description} className="w-full h-48 object-cover rounded-lg cursor-pointer" onClick={() => handleImageClick(item.image)} onError={(e) => { console.error(`Image load failed for ${item.image}:`, e); e.target.src = "https://via.placeholder.com/150x150?text=No+Image"; }} />
                  <p className="mt-2 text-gray-600"><strong>Category:</strong> {item.category}</p>
                  <p className="mt-1 text-gray-600"><strong>Description:</strong> {item.description}</p>
                  <p className="mt-1 text-gray-600"><strong>Price:</strong> ${item.price.toFixed(2)}</p>
                  {item.sold && <p className="text-red-500 font-bold mt-1">SOLD</p>}
                  {adminMode && (
                    <div className="mt-2 flex space-x-2">
                      <button onClick={() => handleEditItem(item)} className="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-700">Edit</button>
                      <button onClick={() => handleDeleteItem(item.id)} className="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-700">Delete</button>
                    </div>
                  )}
                </div>
              ))}
            </div>
            {adminMode && !editItem && (
              <div className="max-w-md mx-auto mt-8">
                <h3 className="text-2xl font-bold text-center mb-4 candy-text">Add New Item</h3>
                <form onSubmit={handleAddItem} className="space-y-4">
                  <div>
                    <label htmlFor="category" className="block text-gray-600">Category</label>
                    <select id="category" value={newItem.category} onChange={(e) => setNewItem({ ...newItem, category: e.target.value })} className="w-full p-2 border rounded" required>
                      <option value="Candy">Candy</option>
                      <option value="Clothing">Clothing</option>
                      <option value="Crafted Items">Crafted Items</option>
                    </select>
                  </div>
                  <div>
                    <label htmlFor="image" className="block text-gray-600">Image</label>
                    <input id="image" type="file" accept="image/*" onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })} className="w-full p-2 border rounded" required />
                  </div>
                  <div>
                    <label htmlFor="description" className="block text-gray-600">Description</label>
                    <input id="description" type="text" value={newItem.description} onChange={(e) => setNewItem({ ...newItem, description: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="price" className="block text-gray-600">Price</label>
                    <input id="price" type="number" step="0.01" value={newItem.price} onChange={(e) => setNewItem({ ...newItem, price: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="sold" className="block text-gray-600">Sold (One-of-a-Kind)</label>
                    <input id="sold" type="checkbox" checked={newItem.sold} onChange={(e) => setNewItem({ ...newItem, sold: e.target.checked })} className="mr-2" />
                  </div>
                  <button type="submit" className="w-full bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Add Item</button>
                </form>
              </div>
            )}
            {adminMode && editItem && (
              <div className="max-w-md mx-auto mt-8">
                <h3 className="text-2xl font-bold text-center mb-4 candy-text">Edit Item</h3>
                <form onSubmit={handleEditSubmit} className="space-y-4">
                  <div>
                    <label htmlFor="edit-category" className="block text-gray-600">Category</label>
                    <select id="edit-category" value={editItem.category} onChange={(e) => setEditItem({ ...editItem, category: e.target.value })} className="w-full p-2 border rounded" required>
                      <option value="Candy">Candy</option>
                      <option value="Clothing">Clothing</option>
                      <option value="Crafted Items">Crafted Items</option>
                    </select>
                  </div>
                  <div>
                    <label htmlFor="edit-image" className="block text-gray-600">Image</label>
                    <input id="edit-image" type="file" accept="image/*" onChange={(e) => setEditItem({ ...editItem, image: e.target.files[0] })} className="w-full p-2 border rounded" />
                    <p className="text-sm text-gray-500">Current: {editItem.imageUrl}</p>
                  </div>
                  <div>
                    <label htmlFor="edit-description" className="block text-gray-600">Description</label>
                    <input id="edit-description" type="text" value={editItem.description} onChange={(e) => setEditItem({ ...editItem, description: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="edit-price" className="block text-gray-600">Price</label>
                    <input id="edit-price" type="number" step="0.01" value={editItem.price} onChange={(e) => setEditItem({ ...editItem, price: e.target.value })} className="w-full p-2 border rounded" required autocomplete="off" />
                  </div>
                  <div>
                    <label htmlFor="edit-sold" className="block text-gray-600">Sold (One-of-a-Kind)</label>
                    <input id="edit-sold" type="checkbox" checked={editItem.sold} onChange={(e) => setEditItem({ ...editItem, sold: e.target.checked })} className="mr-2" />
                  </div>
                  <div className="flex space-x-4">
                    <button type="submit" className="flex-1 bg-pink-500 text-white p-2 rounded hover:bg-pink-700">Save</button>
                    <button type="button" onClick={() => setEditItem(null)} className="flex-1 bg-gray-500 text-white p-2 rounded hover:bg-gray-700">Cancel</button>
                  </div>
                </form>
              </div>
            )}
          </div>
          <ImageModal isOpen={modalOpen} onClose={() => setModalOpen(false)} imageSrc={selectedImage} />
        </section>
      );
    };

    /** App Component: Main application structure */
    const App = () => {
      const [adminMode, setAdminMode] = React.useState(false);
      return (
        <ErrorBoundary>
          <div>
            <NavBar adminMode={adminMode} setAdminMode={setAdminMode} />
            <Hero />
            <About adminMode={adminMode} />
            <Gallery />
            <Reviews adminMode={adminMode} />
            <Events adminMode={adminMode} />
            <Sale adminMode={adminMode} />
            <Contact />
            <Footer />
          </div>
        </ErrorBoundary>
      );
    };

    /** Render the application */
    try {
      console.log("Attempting to render app");
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
      console.log("App rendered successfully");
    } catch (error) {
      console.error("Error rendering app:", error);
      document.getElementById("root").innerHTML = `
        <div style="text-align: center; color: red; padding: 20px;">
          <h2>Error: Failed to load application</h2>
          <p>${error.message}</p>
          <p>Please check the console for details and contact support.</p>
        </div>
      `;
    }
  </script>
</body>
</html>